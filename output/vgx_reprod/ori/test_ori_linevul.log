08/08/2024 21:40:43 - WARNING - __main__ -   device: mps, n_gpu: 0
Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at microsoft/codebert-base and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
08/08/2024 21:40:46 - INFO - __main__ -   Training/evaluation parameters Namespace(train_data_file='../data/big-vul_dataset/train.csv', output_dir='./saved_models', model_type='roberta', block_size=512, eval_data_file='../data/vgx/test.csv', test_data_file='../data/vgx/test.csv', model_name='12heads_linevul_model.bin', model_name_or_path='microsoft/codebert-base', config_name='', use_non_pretrained_model=False, tokenizer_name='microsoft/codebert-base', code_length=256, do_train=False, do_eval=False, do_test=True, evaluate_during_training=True, do_local_explanation=False, reasoning_method=None, train_batch_size=16, eval_batch_size=16, gradient_accumulation_steps=1, learning_rate=2e-05, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, max_steps=-1, warmup_steps=0, seed=123456, epochs=10, effort_at_top_k=0.2, top_k_recall_by_lines=0.01, top_k_recall_by_pred_prob=0.2, do_sorting_by_line_scores=False, do_sorting_by_pred_prob=False, top_k_constant=10, num_attention_heads=12, write_raw_preds=False, use_word_level_tokenizer=False, use_non_pretrained_tokenizer=False, finetune_base_model=None, do_finetune=False, aug_vuln_data_file=None, aug_nonvuln_data_file=None, n_gpu=0, device='mps')
  0%|          | 0/18169 [00:00<?, ?it/s]  1%|          | 96/18169 [00:00<00:19, 946.37it/s]  1%|          | 191/18169 [00:00<00:20, 856.64it/s]  2%|▏         | 316/18169 [00:00<00:17, 1021.68it/s]  2%|▏         | 420/18169 [00:00<00:18, 959.97it/s]   3%|▎         | 518/18169 [00:00<00:18, 932.58it/s]  4%|▎         | 670/18169 [00:00<00:15, 1117.86it/s]  4%|▍         | 784/18169 [00:00<00:19, 882.66it/s]   5%|▍         | 906/18169 [00:00<00:17, 963.91it/s]  6%|▌         | 1038/18169 [00:01<00:16, 1057.49it/s]  6%|▋         | 1151/18169 [00:01<00:16, 1026.57it/s]  7%|▋         | 1261/18169 [00:01<00:16, 1044.17it/s]  8%|▊         | 1388/18169 [00:01<00:15, 1102.85it/s]  8%|▊         | 1501/18169 [00:01<00:21, 759.05it/s]   9%|▉         | 1614/18169 [00:01<00:19, 838.68it/s] 10%|▉         | 1745/18169 [00:01<00:17, 948.51it/s] 11%|█         | 1909/18169 [00:01<00:14, 1122.78it/s] 11%|█         | 2034/18169 [00:02<00:14, 1148.67it/s] 12%|█▏        | 2158/18169 [00:02<00:15, 1033.58it/s] 13%|█▎        | 2290/18169 [00:02<00:14, 1074.10it/s] 13%|█▎        | 2404/18169 [00:02<00:14, 1077.70it/s] 14%|█▍        | 2554/18169 [00:02<00:13, 1191.61it/s] 15%|█▍        | 2678/18169 [00:02<00:13, 1179.30it/s] 15%|█▌        | 2799/18169 [00:02<00:12, 1187.48it/s] 16%|█▌        | 2920/18169 [00:02<00:13, 1161.93it/s] 17%|█▋        | 3038/18169 [00:02<00:14, 1037.65it/s] 17%|█▋        | 3160/18169 [00:03<00:13, 1083.95it/s] 18%|█▊        | 3275/18169 [00:03<00:13, 1095.40it/s] 19%|█▊        | 3387/18169 [00:03<00:13, 1063.66it/s] 19%|█▉        | 3508/18169 [00:03<00:13, 1102.90it/s] 20%|██        | 3659/18169 [00:03<00:11, 1217.81it/s] 21%|██        | 3783/18169 [00:03<00:12, 1137.89it/s] 22%|██▏       | 3940/18169 [00:03<00:11, 1241.95it/s] 22%|██▏       | 4067/18169 [00:03<00:11, 1215.84it/s] 23%|██▎       | 4193/18169 [00:03<00:11, 1217.33it/s] 24%|██▍       | 4320/18169 [00:04<00:11, 1227.97it/s] 25%|██▍       | 4472/18169 [00:04<00:10, 1305.79it/s] 25%|██▌       | 4604/18169 [00:04<00:10, 1266.51it/s] 26%|██▌       | 4739/18169 [00:04<00:10, 1260.87it/s] 27%|██▋       | 4866/18169 [00:04<00:11, 1185.30it/s] 27%|██▋       | 4991/18169 [00:04<00:11, 1192.65it/s] 28%|██▊       | 5112/18169 [00:04<00:11, 1093.10it/s] 29%|██▉       | 5266/18169 [00:04<00:10, 1209.71it/s] 30%|██▉       | 5390/18169 [00:04<00:11, 1137.94it/s] 30%|███       | 5521/18169 [00:05<00:10, 1183.51it/s] 31%|███       | 5642/18169 [00:05<00:10, 1169.65it/s] 32%|███▏      | 5770/18169 [00:05<00:10, 1198.06it/s] 32%|███▏      | 5891/18169 [00:05<00:10, 1145.99it/s] 33%|███▎      | 6007/18169 [00:05<00:11, 1101.76it/s] 34%|███▎      | 6119/18169 [00:05<00:10, 1104.09it/s] 34%|███▍      | 6266/18169 [00:05<00:09, 1205.33it/s] 35%|███▌      | 6388/18169 [00:05<00:12, 970.72it/s]  36%|███▌      | 6515/18169 [00:05<00:11, 1044.05it/s] 37%|███▋      | 6642/18169 [00:06<00:10, 1092.41it/s] 37%|███▋      | 6785/18169 [00:06<00:09, 1179.81it/s] 38%|███▊      | 6908/18169 [00:06<00:10, 1093.17it/s] 39%|███▊      | 7034/18169 [00:06<00:09, 1133.52it/s] 39%|███▉      | 7151/18169 [00:06<00:09, 1128.29it/s] 40%|████      | 7298/18169 [00:06<00:08, 1223.33it/s] 41%|████      | 7423/18169 [00:06<00:11, 953.98it/s]  41%|████▏     | 7538/18169 [00:06<00:10, 999.40it/s] 42%|████▏     | 7700/18169 [00:07<00:09, 1157.21it/s] 43%|████▎     | 7847/18169 [00:07<00:08, 1237.01it/s] 44%|████▍     | 7978/18169 [00:07<00:08, 1235.18it/s] 45%|████▍     | 8107/18169 [00:07<00:08, 1230.55it/s] 46%|████▌     | 8269/18169 [00:07<00:07, 1335.26it/s] 46%|████▋     | 8418/18169 [00:07<00:07, 1373.20it/s] 47%|████▋     | 8558/18169 [00:07<00:07, 1362.62it/s] 48%|████▊     | 8696/18169 [00:07<00:06, 1355.36it/s] 49%|████▉     | 8858/18169 [00:07<00:06, 1368.87it/s] 50%|████▉     | 8996/18169 [00:07<00:07, 1268.67it/s] 50%|█████     | 9126/18169 [00:08<00:07, 1262.06it/s] 51%|█████     | 9254/18169 [00:08<00:07, 1174.79it/s] 52%|█████▏    | 9374/18169 [00:08<00:07, 1172.89it/s] 52%|█████▏    | 9500/18169 [00:08<00:07, 1192.52it/s] 53%|█████▎    | 9656/18169 [00:08<00:06, 1290.55it/s] 54%|█████▍    | 9787/18169 [00:08<00:06, 1263.33it/s] 55%|█████▍    | 9915/18169 [00:08<00:06, 1214.27it/s] 55%|█████▌    | 10038/18169 [00:08<00:06, 1196.60it/s] 56%|█████▌    | 10177/18169 [00:08<00:06, 1250.89it/s] 57%|█████▋    | 10303/18169 [00:09<00:06, 1189.56it/s] 57%|█████▋    | 10425/18169 [00:09<00:07, 1093.99it/s] 58%|█████▊    | 10581/18169 [00:09<00:06, 1217.39it/s] 59%|█████▉    | 10706/18169 [00:09<00:06, 1181.29it/s] 60%|█████▉    | 10831/18169 [00:09<00:06, 1198.19it/s] 60%|██████    | 10953/18169 [00:09<00:06, 1129.85it/s] 61%|██████    | 11072/18169 [00:09<00:06, 1141.81it/s] 62%|██████▏   | 11188/18169 [00:09<00:06, 1131.24it/s] 62%|██████▏   | 11322/18169 [00:09<00:05, 1189.73it/s] 63%|██████▎   | 11442/18169 [00:10<00:05, 1187.07it/s] 64%|██████▎   | 11566/18169 [00:10<00:05, 1199.50it/s] 64%|██████▍   | 11687/18169 [00:10<00:05, 1153.57it/s] 65%|██████▍   | 11809/18169 [00:10<00:05, 1158.07it/s] 66%|██████▌   | 11926/18169 [00:10<00:05, 1103.12it/s] 66%|██████▋   | 12056/18169 [00:10<00:05, 1156.43it/s] 67%|██████▋   | 12194/18169 [00:10<00:04, 1218.60it/s] 68%|██████▊   | 12351/18169 [00:10<00:04, 1318.16it/s] 69%|██████▊   | 12484/18169 [00:10<00:04, 1142.31it/s] 70%|██████▉   | 12644/18169 [00:11<00:04, 1261.81it/s] 70%|███████   | 12775/18169 [00:11<00:04, 1182.76it/s] 71%|███████   | 12899/18169 [00:11<00:04, 1193.87it/s] 72%|███████▏  | 13025/18169 [00:11<00:04, 1208.54it/s] 72%|███████▏  | 13149/18169 [00:11<00:04, 1192.07it/s] 73%|███████▎  | 13277/18169 [00:11<00:04, 1216.86it/s] 74%|███████▍  | 13404/18169 [00:11<00:03, 1211.40it/s] 74%|███████▍  | 13534/18169 [00:11<00:03, 1236.61it/s] 75%|███████▌  | 13659/18169 [00:11<00:03, 1176.17it/s] 76%|███████▌  | 13812/18169 [00:11<00:03, 1275.37it/s] 77%|███████▋  | 13958/18169 [00:12<00:03, 1295.29it/s] 78%|███████▊  | 14114/18169 [00:12<00:02, 1370.36it/s] 79%|███████▊  | 14271/18169 [00:12<00:02, 1427.08it/s] 79%|███████▉  | 14415/18169 [00:12<00:02, 1292.02it/s] 80%|████████  | 14570/18169 [00:12<00:02, 1350.42it/s] 81%|████████  | 14708/18169 [00:12<00:02, 1353.65it/s] 82%|████████▏ | 14849/18169 [00:12<00:02, 1352.45it/s] 83%|████████▎ | 15009/18169 [00:12<00:02, 1421.22it/s] 83%|████████▎ | 15153/18169 [00:12<00:02, 1363.42it/s] 84%|████████▍ | 15317/18169 [00:13<00:02, 1406.86it/s] 85%|████████▌ | 15459/18169 [00:13<00:01, 1375.13it/s] 86%|████████▌ | 15598/18169 [00:13<00:01, 1372.12it/s] 87%|████████▋ | 15736/18169 [00:13<00:01, 1342.13it/s] 87%|████████▋ | 15882/18169 [00:13<00:01, 1374.13it/s] 88%|████████▊ | 16020/18169 [00:13<00:01, 1356.39it/s] 89%|████████▉ | 16156/18169 [00:13<00:01, 1187.42it/s] 90%|████████▉ | 16279/18169 [00:13<00:01, 1195.79it/s] 90%|█████████ | 16402/18169 [00:14<00:01, 887.30it/s]  91%|█████████ | 16563/18169 [00:14<00:01, 1049.21it/s] 92%|█████████▏| 16696/18169 [00:14<00:01, 1110.95it/s] 93%|█████████▎| 16821/18169 [00:14<00:01, 1142.80it/s] 93%|█████████▎| 16944/18169 [00:14<00:01, 1146.73it/s] 94%|█████████▍| 17065/18169 [00:14<00:00, 1153.97it/s] 95%|█████████▍| 17227/18169 [00:14<00:00, 1271.30it/s] 96%|█████████▌| 17358/18169 [00:14<00:00, 1235.69it/s] 96%|█████████▋| 17498/18169 [00:14<00:00, 1279.54it/s] 97%|█████████▋| 17657/18169 [00:15<00:00, 1361.96it/s] 98%|█████████▊| 17803/18169 [00:15<00:00, 1390.14it/s] 99%|█████████▉| 17971/18169 [00:15<00:00, 1473.94it/s]100%|█████████▉| 18120/18169 [00:15<00:00, 1454.40it/s]100%|██████████| 18169/18169 [00:15<00:00, 1183.71it/s]
08/08/2024 21:41:02 - INFO - __main__ -   ***** Running Test *****
08/08/2024 21:41:02 - INFO - __main__ -     Num examples = 18169
08/08/2024 21:41:02 - INFO - __main__ -     Batch size = 16
Batch 0/1136
Batch 50/1136
Batch 100/1136
Batch 150/1136
Batch 200/1136
Batch 250/1136
Batch 300/1136
Batch 350/1136
Batch 400/1136
Batch 450/1136
Batch 500/1136
Batch 550/1136
Batch 600/1136
Batch 650/1136
Batch 700/1136
Batch 750/1136
Batch 800/1136
Batch 850/1136
Batch 900/1136
Batch 950/1136
Batch 1000/1136
Batch 1050/1136
Batch 1100/1136
08/08/2024 21:45:23 - INFO - __main__ -   ***** Test results *****
08/08/2024 21:45:23 - INFO - __main__ -     test_accuracy = 0.9077
08/08/2024 21:45:23 - INFO - __main__ -     test_f1 = 0.0012
08/08/2024 21:45:23 - INFO - __main__ -     test_precision = 0.0667
08/08/2024 21:45:23 - INFO - __main__ -     test_recall = 0.0006
08/08/2024 21:45:23 - INFO - __main__ -     test_threshold = 0.5
