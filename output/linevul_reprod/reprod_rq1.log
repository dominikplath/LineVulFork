08/08/2024 21:21:14 - WARNING - __main__ -   device: mps, n_gpu: 0
Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at microsoft/codebert-base and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
08/08/2024 21:21:18 - INFO - __main__ -   Training/evaluation parameters Namespace(train_data_file='../data/big-vul_dataset/train.csv', output_dir='./saved_models', model_type='roberta', block_size=512, eval_data_file='../data/big-vul_dataset/val.csv', test_data_file='../data/big-vul_dataset/test.csv', model_name='12heads_linevul_model.bin', model_name_or_path='microsoft/codebert-base', config_name='', use_non_pretrained_model=False, tokenizer_name='microsoft/codebert-base', code_length=256, do_train=False, do_eval=False, do_test=True, evaluate_during_training=False, do_local_explanation=False, reasoning_method=None, train_batch_size=4, eval_batch_size=16, gradient_accumulation_steps=1, learning_rate=5e-05, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, max_steps=-1, warmup_steps=0, seed=42, epochs=1, effort_at_top_k=0.2, top_k_recall_by_lines=0.01, top_k_recall_by_pred_prob=0.2, do_sorting_by_line_scores=False, do_sorting_by_pred_prob=False, top_k_constant=10, num_attention_heads=12, write_raw_preds=False, use_word_level_tokenizer=False, use_non_pretrained_tokenizer=False, finetune_base_model=None, do_finetune=False, aug_vuln_data_file=None, aug_nonvuln_data_file=None, n_gpu=0, device='mps')
  0%|          | 0/18864 [00:00<?, ?it/s]  1%|          | 139/18864 [00:00<00:13, 1369.76it/s]  1%|▏         | 276/18864 [00:00<00:14, 1268.27it/s]  2%|▏         | 409/18864 [00:00<00:14, 1289.94it/s]  3%|▎         | 548/18864 [00:00<00:14, 1292.41it/s]  4%|▎         | 696/18864 [00:00<00:13, 1354.97it/s]  4%|▍         | 832/18864 [00:00<00:14, 1286.50it/s]  5%|▌         | 962/18864 [00:00<00:14, 1208.47it/s]  6%|▌         | 1125/18864 [00:00<00:13, 1327.80it/s]  7%|▋         | 1281/18864 [00:00<00:12, 1396.08it/s]  8%|▊         | 1428/18864 [00:01<00:12, 1404.04it/s]  8%|▊         | 1577/18864 [00:01<00:12, 1428.86it/s]  9%|▉         | 1736/18864 [00:01<00:11, 1474.66it/s] 10%|█         | 1908/18864 [00:01<00:11, 1539.43it/s] 11%|█         | 2080/18864 [00:01<00:10, 1592.78it/s] 12%|█▏        | 2254/18864 [00:01<00:10, 1629.15it/s] 13%|█▎        | 2418/18864 [00:01<00:10, 1572.59it/s] 14%|█▎        | 2576/18864 [00:01<00:11, 1415.11it/s] 14%|█▍        | 2721/18864 [00:01<00:11, 1366.37it/s] 15%|█▌        | 2876/18864 [00:02<00:11, 1406.16it/s] 16%|█▌        | 3023/18864 [00:02<00:11, 1419.44it/s] 17%|█▋        | 3167/18864 [00:02<00:11, 1404.41it/s] 18%|█▊        | 3327/18864 [00:02<00:10, 1459.15it/s] 18%|█▊        | 3480/18864 [00:02<00:10, 1476.95it/s] 19%|█▉        | 3629/18864 [00:02<00:11, 1361.32it/s] 20%|██        | 3775/18864 [00:02<00:10, 1388.19it/s] 21%|██        | 3937/18864 [00:02<00:10, 1451.90it/s] 22%|██▏       | 4105/18864 [00:02<00:09, 1516.25it/s] 23%|██▎       | 4258/18864 [00:02<00:09, 1477.81it/s] 23%|██▎       | 4407/18864 [00:03<00:10, 1363.92it/s] 24%|██▍       | 4604/18864 [00:03<00:09, 1529.71it/s] 25%|██▌       | 4761/18864 [00:03<00:09, 1433.77it/s] 26%|██▌       | 4916/18864 [00:03<00:09, 1464.72it/s] 27%|██▋       | 5101/18864 [00:03<00:08, 1571.03it/s] 28%|██▊       | 5261/18864 [00:03<00:09, 1489.36it/s] 29%|██▊       | 5413/18864 [00:03<00:09, 1485.48it/s] 30%|██▉       | 5585/18864 [00:03<00:08, 1550.25it/s] 30%|███       | 5742/18864 [00:03<00:08, 1534.57it/s] 31%|███▏      | 5897/18864 [00:04<00:08, 1528.85it/s] 32%|███▏      | 6051/18864 [00:04<00:08, 1483.44it/s] 33%|███▎      | 6203/18864 [00:04<00:08, 1489.47it/s] 34%|███▎      | 6356/18864 [00:04<00:08, 1498.03it/s] 35%|███▍      | 6547/18864 [00:04<00:07, 1610.42it/s] 36%|███▌      | 6709/18864 [00:04<00:07, 1570.18it/s] 36%|███▋      | 6867/18864 [00:04<00:08, 1479.66it/s] 37%|███▋      | 7028/18864 [00:04<00:07, 1515.69it/s] 38%|███▊      | 7182/18864 [00:04<00:07, 1511.98it/s] 39%|███▉      | 7334/18864 [00:05<00:08, 1420.14it/s] 40%|███▉      | 7501/18864 [00:05<00:07, 1485.64it/s] 41%|████      | 7671/18864 [00:05<00:07, 1543.74it/s] 41%|████▏     | 7827/18864 [00:05<00:07, 1544.20it/s] 42%|████▏     | 7983/18864 [00:05<00:07, 1461.48it/s] 43%|████▎     | 8131/18864 [00:05<00:07, 1465.03it/s] 44%|████▍     | 8305/18864 [00:05<00:06, 1542.95it/s] 45%|████▌     | 8490/18864 [00:05<00:06, 1629.46it/s] 46%|████▌     | 8654/18864 [00:05<00:06, 1602.09it/s] 47%|████▋     | 8826/18864 [00:05<00:06, 1635.85it/s] 48%|████▊     | 8991/18864 [00:06<00:06, 1562.89it/s] 49%|████▊     | 9153/18864 [00:06<00:06, 1575.00it/s] 49%|████▉     | 9312/18864 [00:06<00:06, 1510.76it/s] 50%|█████     | 9465/18864 [00:06<00:06, 1503.19it/s] 51%|█████     | 9650/18864 [00:06<00:05, 1602.41it/s] 52%|█████▏    | 9869/18864 [00:06<00:05, 1772.07it/s] 53%|█████▎    | 10048/18864 [00:06<00:05, 1623.10it/s] 54%|█████▍    | 10215/18864 [00:06<00:05, 1634.68it/s] 55%|█████▌    | 10381/18864 [00:06<00:05, 1536.89it/s] 56%|█████▌    | 10549/18864 [00:07<00:05, 1571.03it/s] 57%|█████▋    | 10712/18864 [00:07<00:05, 1586.22it/s] 58%|█████▊    | 10873/18864 [00:07<00:05, 1487.59it/s] 58%|█████▊    | 11025/18864 [00:07<00:05, 1494.65it/s] 59%|█████▉    | 11192/18864 [00:07<00:04, 1542.79it/s] 60%|██████    | 11362/18864 [00:07<00:04, 1582.33it/s] 61%|██████    | 11522/18864 [00:07<00:05, 1301.06it/s] 62%|██████▏   | 11686/18864 [00:07<00:05, 1355.33it/s] 63%|██████▎   | 11862/18864 [00:07<00:04, 1456.27it/s] 64%|██████▎   | 12014/18864 [00:08<00:04, 1463.16it/s] 65%|██████▍   | 12174/18864 [00:08<00:04, 1498.30it/s] 65%|██████▌   | 12330/18864 [00:08<00:04, 1513.54it/s] 66%|██████▌   | 12486/18864 [00:08<00:04, 1524.65it/s] 67%|██████▋   | 12653/18864 [00:08<00:03, 1566.84it/s] 68%|██████▊   | 12818/18864 [00:08<00:03, 1590.25it/s] 69%|██████▉   | 12978/18864 [00:08<00:03, 1572.80it/s] 70%|██████▉   | 13158/18864 [00:08<00:03, 1630.57it/s] 71%|███████   | 13327/18864 [00:08<00:03, 1640.29it/s] 72%|███████▏  | 13492/18864 [00:09<00:03, 1588.71it/s] 72%|███████▏  | 13652/18864 [00:09<00:03, 1586.46it/s] 73%|███████▎  | 13824/18864 [00:09<00:03, 1624.26it/s] 74%|███████▍  | 13987/18864 [00:09<00:03, 1623.98it/s] 75%|███████▌  | 14150/18864 [00:09<00:02, 1623.51it/s] 76%|███████▌  | 14313/18864 [00:09<00:02, 1610.43it/s] 77%|███████▋  | 14501/18864 [00:09<00:02, 1688.58it/s] 78%|███████▊  | 14671/18864 [00:09<00:02, 1573.23it/s] 79%|███████▉  | 14873/18864 [00:09<00:02, 1698.60it/s] 80%|███████▉  | 15046/18864 [00:09<00:02, 1707.27it/s] 81%|████████  | 15238/18864 [00:10<00:02, 1768.84it/s] 82%|████████▏ | 15417/18864 [00:10<00:02, 1722.80it/s] 83%|████████▎ | 15591/18864 [00:10<00:02, 1629.86it/s] 84%|████████▎ | 15768/18864 [00:10<00:01, 1667.75it/s] 85%|████████▍ | 15970/18864 [00:10<00:01, 1764.08it/s] 86%|████████▌ | 16148/18864 [00:10<00:01, 1694.50it/s] 87%|████████▋ | 16319/18864 [00:10<00:01, 1524.49it/s] 88%|████████▊ | 16507/18864 [00:10<00:01, 1618.47it/s] 88%|████████▊ | 16690/18864 [00:10<00:01, 1674.55it/s] 89%|████████▉ | 16873/18864 [00:11<00:01, 1713.92it/s] 90%|█████████ | 17052/18864 [00:11<00:01, 1735.67it/s] 91%|█████████▏| 17233/18864 [00:11<00:00, 1756.10it/s] 92%|█████████▏| 17425/18864 [00:11<00:00, 1792.69it/s] 93%|█████████▎| 17606/18864 [00:11<00:00, 1668.87it/s] 94%|█████████▍| 17776/18864 [00:11<00:00, 1605.69it/s] 95%|█████████▌| 17950/18864 [00:11<00:00, 1640.86it/s] 96%|█████████▌| 18116/18864 [00:11<00:00, 1643.07it/s] 97%|█████████▋| 18282/18864 [00:11<00:00, 1595.95it/s] 98%|█████████▊| 18453/18864 [00:11<00:00, 1626.09it/s] 99%|█████████▊| 18617/18864 [00:12<00:00, 1562.88it/s]100%|█████████▉| 18775/18864 [00:12<00:00, 1521.99it/s]100%|██████████| 18864/18864 [00:12<00:00, 1536.03it/s]
08/08/2024 21:21:34 - INFO - __main__ -   ***** Running Test *****
08/08/2024 21:21:34 - INFO - __main__ -     Num examples = 18864
08/08/2024 21:21:34 - INFO - __main__ -     Batch size = 16
08/08/2024 21:26:05 - INFO - __main__ -   ***** Test results *****
08/08/2024 21:26:05 - INFO - __main__ -     test_accuracy = 0.9909
08/08/2024 21:26:05 - INFO - __main__ -     test_f1 = 0.9142
08/08/2024 21:26:05 - INFO - __main__ -     test_precision = 0.9712
08/08/2024 21:26:05 - INFO - __main__ -     test_recall = 0.8635
08/08/2024 21:26:05 - INFO - __main__ -     test_threshold = 0.5
Batch 0/1179
Batch 50/1179
Batch 100/1179
Batch 150/1179
Batch 200/1179
Batch 250/1179
Batch 300/1179
Batch 350/1179
Batch 400/1179
Batch 450/1179
Batch 500/1179
Batch 550/1179
Batch 600/1179
Batch 650/1179
Batch 700/1179
Batch 750/1179
Batch 800/1179
Batch 850/1179
Batch 900/1179
Batch 950/1179
Batch 1000/1179
Batch 1050/1179
Batch 1100/1179
Batch 1150/1179
