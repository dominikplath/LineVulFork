09/17/2024 15:10:45 - WARNING - __main__ -   device: mps, n_gpu: 0
Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at microsoft/codebert-base and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
09/17/2024 15:10:49 - INFO - __main__ -   Training/evaluation parameters Namespace(train_data_file='../data/big-vul_dataset/train.csv', output_dir='./saved_models', model_type='roberta', block_size=512, eval_data_file='../data/big-vul_dataset/val.csv', test_data_file='../data/big-vul_dataset/test.csv', model_name='12heads_linevul_model.bin', model_name_or_path='microsoft/codebert-base', config_name='', use_non_pretrained_model=False, tokenizer_name='microsoft/codebert-base', code_length=256, do_train=False, do_eval=False, do_test=True, evaluate_during_training=False, do_local_explanation=False, reasoning_method=None, train_batch_size=4, eval_batch_size=16, gradient_accumulation_steps=1, learning_rate=5e-05, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, max_steps=-1, warmup_steps=0, seed=42, epochs=1, effort_at_top_k=0.2, top_k_recall_by_lines=0.01, top_k_recall_by_pred_prob=0.2, do_sorting_by_line_scores=False, do_sorting_by_pred_prob=False, top_k_constant=10, num_attention_heads=12, write_raw_preds=False, use_word_level_tokenizer=False, use_non_pretrained_tokenizer=False, finetune_base_model=None, do_finetune=False, aug_train_data_files=None, n_gpu=0, device='mps')
  0%|          | 0/18864 [00:00<?, ?it/s]  1%|          | 137/18864 [00:00<00:13, 1361.93it/s]  1%|▏         | 274/18864 [00:00<00:15, 1237.22it/s]  2%|▏         | 402/18864 [00:00<00:14, 1254.49it/s]  3%|▎         | 536/18864 [00:00<00:14, 1281.58it/s]  4%|▎         | 665/18864 [00:00<00:14, 1278.98it/s]  4%|▍         | 798/18864 [00:00<00:14, 1247.68it/s]  5%|▍         | 924/18864 [00:00<00:14, 1238.15it/s]  6%|▌         | 1057/18864 [00:00<00:14, 1264.40it/s]  6%|▋         | 1198/18864 [00:00<00:13, 1308.66it/s]  7%|▋         | 1359/18864 [00:01<00:12, 1399.99it/s]  8%|▊         | 1500/18864 [00:01<00:12, 1378.60it/s]  9%|▉         | 1656/18864 [00:01<00:12, 1429.22it/s] 10%|▉         | 1829/18864 [00:01<00:11, 1509.35it/s] 11%|█         | 1993/18864 [00:01<00:10, 1539.41it/s] 11%|█▏        | 2163/18864 [00:01<00:10, 1582.74it/s] 12%|█▏        | 2322/18864 [00:01<00:10, 1523.72it/s] 13%|█▎        | 2475/18864 [00:01<00:11, 1469.11it/s] 14%|█▍        | 2623/18864 [00:01<00:12, 1314.09it/s] 15%|█▍        | 2780/18864 [00:02<00:11, 1380.68it/s] 15%|█▌        | 2922/18864 [00:02<00:11, 1358.39it/s] 16%|█▋        | 3083/18864 [00:02<00:11, 1426.97it/s] 17%|█▋        | 3228/18864 [00:02<00:11, 1363.23it/s] 18%|█▊        | 3379/18864 [00:02<00:11, 1399.23it/s] 19%|█▉        | 3544/18864 [00:02<00:10, 1466.78it/s] 20%|█▉        | 3693/18864 [00:02<00:11, 1327.16it/s] 20%|██        | 3840/18864 [00:02<00:11, 1361.35it/s] 21%|██▏       | 4020/18864 [00:02<00:10, 1480.02it/s] 22%|██▏       | 4171/18864 [00:02<00:10, 1468.29it/s] 23%|██▎       | 4320/18864 [00:03<00:10, 1416.54it/s] 24%|██▎       | 4464/18864 [00:03<00:10, 1322.65it/s] 25%|██▍       | 4630/18864 [00:03<00:10, 1368.01it/s] 25%|██▌       | 4769/18864 [00:03<00:10, 1327.71it/s] 26%|██▌       | 4903/18864 [00:03<00:10, 1328.65it/s] 27%|██▋       | 5083/18864 [00:03<00:09, 1459.76it/s] 28%|██▊       | 5231/18864 [00:03<00:10, 1359.93it/s] 28%|██▊       | 5370/18864 [00:03<00:09, 1367.29it/s] 29%|██▉       | 5514/18864 [00:03<00:09, 1387.79it/s] 30%|███       | 5668/18864 [00:04<00:09, 1428.30it/s] 31%|███       | 5820/18864 [00:04<00:08, 1452.41it/s] 32%|███▏      | 5967/18864 [00:04<00:09, 1384.51it/s] 32%|███▏      | 6123/18864 [00:04<00:08, 1417.15it/s] 33%|███▎      | 6272/18864 [00:04<00:08, 1435.16it/s] 34%|███▍      | 6435/18864 [00:04<00:08, 1491.44it/s] 35%|███▍      | 6601/18864 [00:04<00:07, 1540.60it/s] 36%|███▌      | 6756/18864 [00:04<00:08, 1496.43it/s] 37%|███▋      | 6907/18864 [00:04<00:08, 1404.30it/s] 37%|███▋      | 7067/18864 [00:05<00:08, 1456.67it/s] 38%|███▊      | 7215/18864 [00:05<00:08, 1332.67it/s] 39%|███▉      | 7376/18864 [00:05<00:08, 1407.13it/s] 40%|███▉      | 7538/18864 [00:05<00:07, 1461.26it/s] 41%|████      | 7703/18864 [00:05<00:07, 1449.35it/s] 42%|████▏     | 7858/18864 [00:05<00:07, 1468.18it/s] 42%|████▏     | 8007/18864 [00:05<00:07, 1460.13it/s] 43%|████▎     | 8154/18864 [00:05<00:07, 1418.25it/s] 44%|████▍     | 8319/18864 [00:05<00:07, 1483.30it/s] 45%|████▌     | 8503/18864 [00:06<00:06, 1586.13it/s] 46%|████▌     | 8663/18864 [00:06<00:06, 1546.85it/s] 47%|████▋     | 8832/18864 [00:06<00:06, 1587.19it/s] 48%|████▊     | 8992/18864 [00:06<00:06, 1524.81it/s] 48%|████▊     | 9148/18864 [00:06<00:06, 1533.96it/s] 49%|████▉     | 9303/18864 [00:06<00:06, 1467.07it/s] 50%|█████     | 9458/18864 [00:06<00:06, 1487.22it/s] 51%|█████     | 9609/18864 [00:06<00:06, 1493.05it/s] 52%|█████▏    | 9816/18864 [00:06<00:05, 1651.96it/s] 53%|█████▎    | 9989/18864 [00:06<00:05, 1656.85it/s] 54%|█████▍    | 10156/18864 [00:07<00:05, 1512.50it/s] 55%|█████▍    | 10324/18864 [00:07<00:05, 1536.87it/s] 56%|█████▌    | 10480/18864 [00:07<00:05, 1502.21it/s] 56%|█████▋    | 10632/18864 [00:07<00:05, 1477.17it/s] 57%|█████▋    | 10805/18864 [00:07<00:05, 1547.83it/s] 58%|█████▊    | 10961/18864 [00:07<00:05, 1354.13it/s] 59%|█████▉    | 11110/18864 [00:07<00:05, 1378.67it/s] 60%|█████▉    | 11252/18864 [00:07<00:06, 1157.24it/s] 60%|██████    | 11406/18864 [00:08<00:05, 1244.25it/s] 61%|██████    | 11538/18864 [00:08<00:06, 1087.48it/s] 62%|██████▏   | 11688/18864 [00:08<00:06, 1184.77it/s] 63%|██████▎   | 11861/18864 [00:08<00:05, 1323.76it/s] 64%|██████▎   | 12002/18864 [00:08<00:05, 1334.41it/s] 64%|██████▍   | 12160/18864 [00:08<00:04, 1400.70it/s] 65%|██████▌   | 12318/18864 [00:08<00:04, 1448.80it/s] 66%|██████▌   | 12467/18864 [00:08<00:04, 1459.01it/s] 67%|██████▋   | 12616/18864 [00:08<00:04, 1467.48it/s] 68%|██████▊   | 12778/18864 [00:09<00:04, 1508.98it/s] 69%|██████▊   | 12937/18864 [00:09<00:03, 1532.08it/s] 69%|██████▉   | 13102/18864 [00:09<00:03, 1560.98it/s] 70%|███████   | 13263/18864 [00:09<00:03, 1574.03it/s] 71%|███████   | 13421/18864 [00:09<00:03, 1575.72it/s] 72%|███████▏  | 13580/18864 [00:09<00:03, 1572.49it/s] 73%|███████▎  | 13738/18864 [00:09<00:03, 1554.83it/s] 74%|███████▎  | 13899/18864 [00:09<00:03, 1570.18it/s] 75%|███████▍  | 14075/18864 [00:09<00:02, 1625.36it/s] 75%|███████▌  | 14238/18864 [00:09<00:02, 1568.69it/s] 76%|███████▋  | 14417/18864 [00:10<00:02, 1632.68it/s] 77%|███████▋  | 14581/18864 [00:10<00:02, 1605.28it/s] 78%|███████▊  | 14742/18864 [00:10<00:02, 1569.58it/s] 79%|███████▉  | 14940/18864 [00:10<00:02, 1683.54it/s] 80%|████████  | 15109/18864 [00:10<00:02, 1654.58it/s] 81%|████████  | 15316/18864 [00:10<00:02, 1747.78it/s] 82%|████████▏ | 15492/18864 [00:10<00:02, 1647.17it/s] 83%|████████▎ | 15674/18864 [00:10<00:01, 1690.32it/s] 84%|████████▍ | 15882/18864 [00:10<00:01, 1799.10it/s] 85%|████████▌ | 16064/18864 [00:10<00:01, 1788.32it/s] 86%|████████▌ | 16244/18864 [00:11<00:01, 1510.69it/s] 87%|████████▋ | 16407/18864 [00:11<00:01, 1540.36it/s] 88%|████████▊ | 16606/18864 [00:11<00:01, 1661.49it/s] 89%|████████▉ | 16778/18864 [00:11<00:01, 1653.91it/s] 90%|████████▉ | 16951/18864 [00:11<00:01, 1675.23it/s] 91%|█████████ | 17143/18864 [00:11<00:00, 1737.59it/s] 92%|█████████▏| 17334/18864 [00:11<00:00, 1785.61it/s] 93%|█████████▎| 17515/18864 [00:11<00:00, 1731.48it/s] 94%|█████████▍| 17690/18864 [00:12<00:00, 1595.23it/s] 95%|█████████▍| 17853/18864 [00:12<00:00, 1578.53it/s] 96%|█████████▌| 18019/18864 [00:12<00:00, 1601.05it/s] 96%|█████████▋| 18181/18864 [00:12<00:00, 1546.47it/s] 97%|█████████▋| 18347/18864 [00:12<00:00, 1574.77it/s] 98%|█████████▊| 18506/18864 [00:12<00:00, 1530.33it/s] 99%|█████████▉| 18660/18864 [00:12<00:00, 1454.97it/s]100%|█████████▉| 18810/18864 [00:12<00:00, 1467.18it/s]100%|██████████| 18864/18864 [00:12<00:00, 1473.87it/s]
09/17/2024 15:11:06 - INFO - __main__ -   ***** Running Test *****
09/17/2024 15:11:06 - INFO - __main__ -     Num examples = 18864
09/17/2024 15:11:06 - INFO - __main__ -     Batch size = 16
Batch 0/1179
Batch 50/1179
Batch 100/1179
Batch 150/1179
Batch 200/1179
Batch 250/1179
Batch 300/1179
Batch 350/1179
Batch 400/1179
Batch 450/1179
Batch 500/1179
Batch 550/1179
Batch 600/1179
Batch 650/1179
Batch 700/1179
Batch 750/1179
Batch 800/1179
Batch 850/1179
Batch 900/1179
Batch 950/1179
Batch 1000/1179
Batch 1050/1179
Batch 1100/1179
Batch 1150/1179
09/17/2024 15:15:37 - INFO - __main__ -   ***** Test results *****
09/17/2024 15:15:37 - INFO - __main__ -     test_accuracy = 0.9909
09/17/2024 15:15:37 - INFO - __main__ -     test_ap = 0.9341
09/17/2024 15:15:37 - INFO - __main__ -     test_f1 = 0.9142
09/17/2024 15:15:37 - INFO - __main__ -     test_precision = 0.9712
09/17/2024 15:15:37 - INFO - __main__ -     test_recall = 0.8635
09/17/2024 15:15:37 - INFO - __main__ -     test_roc_auc = 0.9786
09/17/2024 15:15:37 - INFO - __main__ -     test_threshold = 0.5
