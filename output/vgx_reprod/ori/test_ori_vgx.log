08/08/2024 21:03:41 - WARNING - __main__ -   device: mps, n_gpu: 0
Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at microsoft/codebert-base and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
08/08/2024 21:03:44 - INFO - __main__ -   Training/evaluation parameters Namespace(train_data_file='../data/big-vul_dataset/train.csv', output_dir='./saved_models', model_type='roberta', block_size=512, eval_data_file='../data/vgx/test.csv', test_data_file='../data/vgx/test.csv', model_name='model_ori.bin', model_name_or_path='microsoft/codebert-base', config_name='', use_non_pretrained_model=False, tokenizer_name='microsoft/codebert-base', code_length=256, do_train=False, do_eval=False, do_test=True, evaluate_during_training=True, do_local_explanation=False, reasoning_method=None, train_batch_size=16, eval_batch_size=16, gradient_accumulation_steps=1, learning_rate=2e-05, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, max_steps=-1, warmup_steps=0, seed=123456, epochs=10, effort_at_top_k=0.2, top_k_recall_by_lines=0.01, top_k_recall_by_pred_prob=0.2, do_sorting_by_line_scores=False, do_sorting_by_pred_prob=False, top_k_constant=10, num_attention_heads=12, write_raw_preds=False, use_word_level_tokenizer=False, use_non_pretrained_tokenizer=False, finetune_base_model=None, do_finetune=False, aug_vuln_data_file=None, aug_nonvuln_data_file=None, n_gpu=0, device='mps')
  0%|          | 0/18169 [00:00<?, ?it/s]  1%|          | 97/18169 [00:00<00:18, 958.24it/s]  1%|          | 193/18169 [00:00<00:20, 886.34it/s]  2%|▏         | 317/18169 [00:00<00:17, 1040.40it/s]  2%|▏         | 422/18169 [00:00<00:18, 976.82it/s]   3%|▎         | 521/18169 [00:00<00:18, 950.26it/s]  4%|▍         | 691/18169 [00:00<00:14, 1186.69it/s]  4%|▍         | 812/18169 [00:00<00:18, 919.27it/s]   5%|▌         | 960/18169 [00:00<00:16, 1062.02it/s]  6%|▌         | 1091/18169 [00:01<00:15, 1127.98it/s]  7%|▋         | 1212/18169 [00:01<00:15, 1060.61it/s]  7%|▋         | 1331/18169 [00:01<00:15, 1094.94it/s]  8%|▊         | 1448/18169 [00:01<00:21, 767.79it/s]   9%|▊         | 1573/18169 [00:01<00:19, 868.02it/s]  9%|▉         | 1698/18169 [00:01<00:17, 955.88it/s] 10%|█         | 1870/18169 [00:01<00:14, 1141.60it/s] 11%|█         | 2031/18169 [00:01<00:12, 1261.09it/s] 12%|█▏        | 2168/18169 [00:02<00:14, 1074.44it/s] 13%|█▎        | 2294/18169 [00:02<00:14, 1076.95it/s] 13%|█▎        | 2437/18169 [00:02<00:13, 1163.98it/s] 14%|█▍        | 2586/18169 [00:02<00:12, 1248.17it/s] 15%|█▍        | 2718/18169 [00:02<00:12, 1229.38it/s] 16%|█▌        | 2861/18169 [00:02<00:11, 1284.16it/s] 16%|█▋        | 2994/18169 [00:02<00:13, 1123.17it/s] 17%|█▋        | 3118/18169 [00:02<00:13, 1150.05it/s] 18%|█▊        | 3241/18169 [00:02<00:12, 1171.18it/s] 19%|█▊        | 3362/18169 [00:03<00:13, 1120.17it/s] 19%|█▉        | 3502/18169 [00:03<00:12, 1194.66it/s] 20%|██        | 3660/18169 [00:03<00:11, 1301.44it/s] 21%|██        | 3793/18169 [00:03<00:11, 1226.11it/s] 22%|██▏       | 3945/18169 [00:03<00:10, 1305.66it/s] 22%|██▏       | 4078/18169 [00:03<00:11, 1248.73it/s] 23%|██▎       | 4205/18169 [00:03<00:11, 1236.41it/s] 24%|██▍       | 4346/18169 [00:03<00:10, 1283.01it/s] 25%|██▍       | 4501/18169 [00:03<00:10, 1356.96it/s] 26%|██▌       | 4638/18169 [00:04<00:10, 1322.06it/s] 26%|██▋       | 4772/18169 [00:04<00:10, 1284.92it/s] 27%|██▋       | 4902/18169 [00:04<00:10, 1257.89it/s] 28%|██▊       | 5029/18169 [00:04<00:10, 1215.61it/s] 28%|██▊       | 5152/18169 [00:04<00:11, 1177.38it/s] 29%|██▉       | 5295/18169 [00:04<00:10, 1244.75it/s] 30%|██▉       | 5421/18169 [00:04<00:10, 1163.73it/s] 31%|███       | 5573/18169 [00:04<00:10, 1258.98it/s] 31%|███▏      | 5701/18169 [00:04<00:10, 1240.71it/s] 32%|███▏      | 5827/18169 [00:05<00:10, 1210.09it/s] 33%|███▎      | 5949/18169 [00:05<00:10, 1162.48it/s] 33%|███▎      | 6078/18169 [00:05<00:10, 1191.09it/s] 34%|███▍      | 6205/18169 [00:05<00:09, 1213.06it/s] 35%|███▍      | 6353/18169 [00:05<00:09, 1289.43it/s] 36%|███▌      | 6483/18169 [00:05<00:10, 1062.60it/s] 36%|███▋      | 6597/18169 [00:05<00:10, 1075.86it/s] 37%|███▋      | 6714/18169 [00:05<00:10, 1099.51it/s] 38%|███▊      | 6860/18169 [00:05<00:09, 1198.12it/s] 38%|███▊      | 6984/18169 [00:06<00:10, 1108.68it/s] 39%|███▉      | 7109/18169 [00:06<00:09, 1111.80it/s] 40%|███▉      | 7262/18169 [00:06<00:08, 1225.28it/s] 41%|████      | 7388/18169 [00:06<00:11, 954.71it/s]  41%|████▏     | 7519/18169 [00:06<00:10, 1038.34it/s] 42%|████▏     | 7690/18169 [00:06<00:08, 1206.78it/s] 43%|████▎     | 7847/18169 [00:06<00:07, 1294.38it/s] 44%|████▍     | 7985/18169 [00:06<00:07, 1282.24it/s] 45%|████▍     | 8131/18169 [00:07<00:07, 1330.61it/s] 46%|████▌     | 8285/18169 [00:07<00:07, 1389.52it/s] 47%|████▋     | 8453/18169 [00:07<00:06, 1470.34it/s] 47%|████▋     | 8603/18169 [00:07<00:06, 1468.42it/s] 48%|████▊     | 8752/18169 [00:07<00:06, 1429.25it/s] 49%|████▉     | 8897/18169 [00:07<00:07, 1315.84it/s] 50%|████▉     | 9046/18169 [00:07<00:06, 1344.77it/s] 51%|█████     | 9183/18169 [00:07<00:07, 1215.16it/s] 51%|█████     | 9311/18169 [00:07<00:07, 1219.13it/s] 52%|█████▏    | 9450/18169 [00:08<00:06, 1257.07it/s] 53%|█████▎    | 9579/18169 [00:08<00:06, 1263.02it/s] 54%|█████▎    | 9733/18169 [00:08<00:06, 1332.71it/s] 54%|█████▍    | 9868/18169 [00:08<00:06, 1319.34it/s] 55%|█████▌    | 10001/18169 [00:08<00:06, 1311.38it/s] 56%|█████▌    | 10133/18169 [00:08<00:06, 1290.77it/s] 56%|█████▋    | 10263/18169 [00:08<00:06, 1267.22it/s] 57%|█████▋    | 10397/18169 [00:08<00:06, 1272.66it/s] 58%|█████▊    | 10525/18169 [00:08<00:06, 1196.73it/s] 59%|█████▊    | 10664/18169 [00:08<00:06, 1249.75it/s] 59%|█████▉    | 10790/18169 [00:09<00:06, 1195.82it/s] 60%|██████    | 10911/18169 [00:09<00:06, 1197.34it/s] 61%|██████    | 11032/18169 [00:09<00:05, 1200.45it/s] 61%|██████▏   | 11153/18169 [00:09<00:06, 1157.86it/s] 62%|██████▏   | 11281/18169 [00:09<00:05, 1192.24it/s] 63%|██████▎   | 11401/18169 [00:09<00:05, 1173.82it/s] 64%|██████▎   | 11554/18169 [00:09<00:05, 1274.00it/s] 64%|██████▍   | 11683/18169 [00:09<00:05, 1210.41it/s] 65%|██████▍   | 11809/18169 [00:09<00:05, 1217.67it/s] 66%|██████▌   | 11932/18169 [00:10<00:05, 1164.06it/s] 66%|██████▋   | 12061/18169 [00:10<00:05, 1196.31it/s] 67%|██████▋   | 12227/18169 [00:10<00:04, 1326.87it/s] 68%|██████▊   | 12364/18169 [00:10<00:04, 1322.84it/s] 69%|██████▉   | 12498/18169 [00:10<00:04, 1232.82it/s] 70%|██████▉   | 12667/18169 [00:10<00:04, 1358.08it/s] 70%|███████   | 12805/18169 [00:10<00:04, 1282.52it/s] 71%|███████   | 12936/18169 [00:10<00:04, 1242.65it/s] 72%|███████▏  | 13062/18169 [00:10<00:04, 1245.89it/s] 73%|███████▎  | 13201/18169 [00:11<00:03, 1284.56it/s] 73%|███████▎  | 13340/18169 [00:11<00:03, 1313.95it/s] 74%|███████▍  | 13473/18169 [00:11<00:03, 1300.89it/s] 75%|███████▍  | 13604/18169 [00:11<00:03, 1236.71it/s] 76%|███████▌  | 13754/18169 [00:11<00:03, 1310.78it/s] 76%|███████▋  | 13897/18169 [00:11<00:03, 1344.79it/s] 77%|███████▋  | 14042/18169 [00:11<00:03, 1372.06it/s] 78%|███████▊  | 14188/18169 [00:11<00:02, 1395.32it/s] 79%|███████▉  | 14329/18169 [00:11<00:02, 1323.51it/s] 80%|███████▉  | 14473/18169 [00:11<00:02, 1342.71it/s] 80%|████████  | 14609/18169 [00:12<00:02, 1346.41it/s] 81%|████████  | 14745/18169 [00:12<00:02, 1325.48it/s] 82%|████████▏ | 14884/18169 [00:12<00:02, 1336.56it/s] 83%|████████▎ | 15038/18169 [00:12<00:02, 1393.96it/s] 84%|████████▎ | 15178/18169 [00:12<00:02, 1356.91it/s] 84%|████████▍ | 15333/18169 [00:12<00:02, 1411.19it/s] 85%|████████▌ | 15475/18169 [00:12<00:02, 1342.70it/s] 86%|████████▌ | 15617/18169 [00:12<00:01, 1360.54it/s] 87%|████████▋ | 15762/18169 [00:12<00:01, 1382.63it/s] 88%|████████▊ | 15904/18169 [00:13<00:01, 1393.27it/s] 88%|████████▊ | 16049/18169 [00:13<00:01, 1406.96it/s] 89%|████████▉ | 16191/18169 [00:13<00:01, 1233.36it/s] 90%|████████▉ | 16319/18169 [00:13<00:01, 947.97it/s]  90%|█████████ | 16431/18169 [00:13<00:01, 984.06it/s] 91%|█████████▏| 16609/18169 [00:13<00:01, 1172.92it/s] 92%|█████████▏| 16740/18169 [00:13<00:01, 1205.31it/s] 93%|█████████▎| 16869/18169 [00:13<00:01, 1176.51it/s] 94%|█████████▎| 17000/18169 [00:13<00:00, 1210.26it/s] 94%|█████████▍| 17167/18169 [00:14<00:00, 1336.47it/s] 95%|█████████▌| 17306/18169 [00:14<00:00, 1346.62it/s] 96%|█████████▌| 17444/18169 [00:14<00:00, 1321.75it/s] 97%|█████████▋| 17621/18169 [00:14<00:00, 1447.80it/s] 98%|█████████▊| 17768/18169 [00:14<00:00, 1427.08it/s] 99%|█████████▉| 17949/18169 [00:14<00:00, 1537.10it/s]100%|█████████▉| 18106/18169 [00:14<00:00, 1545.46it/s]100%|██████████| 18169/18169 [00:14<00:00, 1231.43it/s]
08/08/2024 21:03:59 - INFO - __main__ -   ***** Running Test *****
08/08/2024 21:03:59 - INFO - __main__ -     Num examples = 18169
08/08/2024 21:03:59 - INFO - __main__ -     Batch size = 16
Batch 0/1136
Batch 50/1136
Batch 100/1136
Batch 150/1136
Batch 200/1136
Batch 250/1136
Batch 300/1136
Batch 350/1136
Batch 400/1136
Batch 450/1136
Batch 500/1136
Batch 550/1136
Batch 600/1136
Batch 650/1136
Batch 700/1136
Batch 750/1136
Batch 800/1136
Batch 850/1136
Batch 900/1136
Batch 950/1136
Batch 1000/1136
Batch 1050/1136
Batch 1100/1136
08/08/2024 21:08:21 - INFO - __main__ -   ***** Test results *****
08/08/2024 21:08:21 - INFO - __main__ -     test_accuracy = 0.9043
08/08/2024 21:08:21 - INFO - __main__ -     test_f1 = 0.0461
08/08/2024 21:08:21 - INFO - __main__ -     test_precision = 0.2642
08/08/2024 21:08:21 - INFO - __main__ -     test_recall = 0.0252
08/08/2024 21:08:21 - INFO - __main__ -     test_threshold = 0.5
